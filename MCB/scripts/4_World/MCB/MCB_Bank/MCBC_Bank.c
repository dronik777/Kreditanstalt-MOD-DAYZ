class MCBC_Bank{ int m_HotKeyMenu = -1; ref array<ref MCBC_Bank_Location> m_Locations = new array<ref MCBC_Bank_Location>; private ref MCBC_Bank_Menu m_MCBC_Bank_Menu; void MCBC_Bank() { if ( MCB_INT_DEBUG_LEVEL > 3 ) { MCBC_StaticFunctions.PrintDebug( "[Вход]: MCBC_Bank" ); } } void ~MCBC_Bank() { if ( MCB_INT_DEBUG_LEVEL > 3 ) { MCBC_StaticFunctions.PrintDebug( "[Выход]: MCBC_Bank" ); } } void AddBank( string CVFBFXPQBXNGKUCTWLIYAPID ) { TStringArray CAHGIXFBOBWWKKMQMHYOPEY = {}; CVFBFXPQBXNGKUCTWLIYAPID.Split( "|", CAHGIXFBOBWWKKMQMHYOPEY ); if ( CAHGIXFBOBWWKKMQMHYOPEY.Count() == 2 ) m_Locations.Insert( new MCBC_Bank_Location( CAHGIXFBOBWWKKMQMHYOPEY[0].ToVector(), CAHGIXFBOBWWKKMQMHYOPEY[1].ToInt() ) ); } void OnRPC( string YFMMDFXQOJXYCYYUEIUMXGRG ) { TStringArray MNGJETXHVWXDOOBUQPBWAWIE = {}; int KHEICVNNXPMYSCGFBEEWWPI = -1; string CVFBFXPQBXNGKUCTWLIYAPID = ""; int UBEVOBUDARHQLVRNVHNJYMGB = 0; YFMMDFXQOJXYCYYUEIUMXGRG.Split( "|", MNGJETXHVWXDOOBUQPBWAWIE ); KHEICVNNXPMYSCGFBEEWWPI = MNGJETXHVWXDOOBUQPBWAWIE[0].ToInt(); for ( UBEVOBUDARHQLVRNVHNJYMGB = 1; UBEVOBUDARHQLVRNVHNJYMGB < MNGJETXHVWXDOOBUQPBWAWIE.Count(); UBEVOBUDARHQLVRNVHNJYMGB++ ) { if ( CVFBFXPQBXNGKUCTWLIYAPID == "" ) { CVFBFXPQBXNGKUCTWLIYAPID = MNGJETXHVWXDOOBUQPBWAWIE[UBEVOBUDARHQLVRNVHNJYMGB]; } else { CVFBFXPQBXNGKUCTWLIYAPID = CVFBFXPQBXNGKUCTWLIYAPID + "|" + MNGJETXHVWXDOOBUQPBWAWIE[UBEVOBUDARHQLVRNVHNJYMGB]; } } switch ( KHEICVNNXPMYSCGFBEEWWPI ) { case MCB_INT_STC_PACKET_ID_BANK_DATA: AddBank( CVFBFXPQBXNGKUCTWLIYAPID ); break; case MCB_INT_STC_PACKET_ID_BANK_HOT_KEY: m_HotKeyMenu = CVFBFXPQBXNGKUCTWLIYAPID.ToInt(); break; case MCB_INT_STC_PACKET_ID_BANK_VALUE_BANK: if ( m_MCBC_Bank_Menu ) { m_MCBC_Bank_Menu.SetBankValue( CVFBFXPQBXNGKUCTWLIYAPID ); } break; case MCB_INT_STC_PACKET_ID_BANK_VALUE_CASH: if ( m_MCBC_Bank_Menu ) { m_MCBC_Bank_Menu.SetCashValue( CVFBFXPQBXNGKUCTWLIYAPID ); } break; case MCB_INT_STC_PACKET_ID_BANK_ERROR: if ( m_MCBC_Bank_Menu ) { m_MCBC_Bank_Menu.SetErrorValue( CVFBFXPQBXNGKUCTWLIYAPID ); } break; case MCB_INT_STC_PACKET_ID_BANK_CLEAR_PLAYERS: if ( m_MCBC_Bank_Menu ) { m_MCBC_Bank_Menu.ClearPlayers(); } break; case MCB_INT_STC_PACKET_ID_BANK_PLAYER: if ( m_MCBC_Bank_Menu ) { m_MCBC_Bank_Menu.AddPlayer( CVFBFXPQBXNGKUCTWLIYAPID ); } break; } } bool InLocation() { int UBEVOBUDARHQLVRNVHNJYMGB = 0; PlayerBase DCQJHFOCJEOFGYSHKTPVFG = GetGame().GetPlayer(); vector FYBFAMAGDRAPEEBFULJBULB = "0 0 0"; if ( !DCQJHFOCJEOFGYSHKTPVFG ) { return false; } FYBFAMAGDRAPEEBFULJBULB = DCQJHFOCJEOFGYSHKTPVFG.GetPosition(); for ( UBEVOBUDARHQLVRNVHNJYMGB = 0; UBEVOBUDARHQLVRNVHNJYMGB < m_Locations.Count(); UBEVOBUDARHQLVRNVHNJYMGB++ ) { if ( MCBC_StaticFunctions.Distance2D( FYBFAMAGDRAPEEBFULJBULB, m_Locations[UBEVOBUDARHQLVRNVHNJYMGB].GetPosition() ) <= m_Locations[UBEVOBUDARHQLVRNVHNJYMGB].GetRadius() ) { return true; } } return false; } void OnKeyPress( int RPMEYMVUKPGSFHPKXXGUHTQEU ) { switch ( RPMEYMVUKPGSFHPKXXGUHTQEU ) { case KeyCode.KC_ESCAPE: if ( GetGame().GetUIManager().GetMenu() ) { if ( m_MCBC_Bank_Menu ) { GetGame().GetUIManager().Back(); } } break; case m_HotKeyMenu: if ( GetGame().GetUIManager().GetMenu() ) { if ( m_MCBC_Bank_Menu ) { GetGame().GetUIManager().Back(); return; } } else { if ( !InLocation() ) { MCBC_StaticFunctions.SelfChatMessage( "В данном месте банк не доступен!" ); return; } m_MCBC_Bank_Menu = new MCBC_Bank_Menu(); GetGame().GetUIManager().ShowScriptedMenu( m_MCBC_Bank_Menu, NULL ); } break; } }}